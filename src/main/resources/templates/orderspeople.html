<!DOCTYPE html>
<html lang="ru" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–û—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞ - –ë–∞–≥–µ—Ç–Ω–∞—è –º–∞—Å—Ç–µ—Ä—Å–∫–∞—è</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link th:href="@{/css/stylereg.css}" rel="stylesheet">
    <style>
        .personal-cabinet-btn {
            background: #8B4513;
            color: white;
            border: none;
            padding: 6px 12px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 13px;
            font-weight: 500;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 4px;
            white-space: nowrap;
        }
        
        .personal-cabinet-btn:hover {
            background: #A0522D;
            transform: translateY(-1px);
            box-shadow: 0 2px 8px rgba(139, 69, 19, 0.3);
            color: white;
            text-decoration: none;
        }
        
        .personal-cabinet-btn i {
            font-size: 12px;
        }

        .order-container {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }
        .form-section {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }
        .material-options {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 15px 0;
        }
        .material-option {
            border: 2px solid #ddd;
            padding: 15px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        .material-option:hover {
            border-color: #8B4513;
        }
        .material-option.selected {
            border-color: #8B4513;
            background-color: #f8f9fa;
        }
        .material-info {
            margin-top: 10px;
        }
        
        /* –°—Ç–∏–ª–∏ –¥–ª—è –ø–æ–ª–µ–π –≤–≤–æ–¥–∞ */
        .form-group {
            margin-bottom: 25px;
        }
        
        .form-group h3 {
            color: #333;
            margin-bottom: 15px;
            font-size: 1.2rem;
        }
        
        .dimension-inputs {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }
        
        .input-group {
            margin-bottom: 20px;
        }
        
        .input-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #333;
        }
        
        .input-group input,
        .input-group select,
        .input-group textarea {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 16px;
            transition: all 0.3s ease;
            background-color: white;
            box-sizing: border-box;
        }
        
        .input-group input:focus,
        .input-group select:focus,
        .input-group textarea:focus {
            outline: none;
            border-color: #8B4513;
            box-shadow: 0 0 0 3px rgba(139, 69, 19, 0.1);
        }
        
        .input-group input:hover,
        .input-group select:hover,
        .input-group textarea:hover {
            border-color: #bbb;
        }
        
        .optional-section {
            background: #f8f9fa;
            padding: 25px;
            border-radius: 10px;
            margin: 20px 0;
            border-left: 4px solid #8B4513;
        }
        
        .optional-section h3 {
            color: #333;
            margin-bottom: 20px;
            font-size: 1.2rem;
        }
        
        .btn-primary {
            background: #8B4513;
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            width: 100%;
            margin-top: 10px;
        }
        
        .btn-primary:hover {
            background: #A0522D;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(139, 69, 19, 0.3);
        }
        
        .alert {
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
        }
        
        .alert-success {
            background-color: #d4edda;
            border: 1px solid #c3e6cb;
            color: #155724;
        }
        
        .alert-danger {
            background-color: #f8d7da;
            border: 1px solid #f5c6cb;
            color: #721c24;
        }
        
        .alert-warning {
            background-color: #fff3cd;
            border: 1px solid #ffeaa7;
            color: #856404;
        }
        
        .alert-info {
            background-color: #d1ecf1;
            border: 1px solid #bee5eb;
            color: #0c5460;
        }

        /* –°—Ç–∏–ª—å –¥–ª—è —É—Å–ø–µ—à–Ω–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è */
        .success-message {
            background: #d4edda;
            border: 1px solid #c3e6cb;
            color: #155724;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
            text-align: center;
            font-size: 18px;
            font-weight: 500;
        }

        .success-message i {
            color: #28a745;
            margin-right: 10px;
        }
    </style>
</head>
<body>
<header class="header">
    <div class="autocontainer">
        <div class="header-content">
            <div class="logo">
                <i class="fas fa-palette logo-icon"></i>
                <div class="logo-text">
                    <h1>–ë–∞–≥–µ—Ç–Ω–∞—è –º–∞—Å—Ç–µ—Ä—Å–∫–∞—è</h1>
                    <p>–û—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ –∫–∞—Ä—Ç–∏–Ω –∏ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π —Å 2005 –≥–æ–¥–∞</p>
                </div>
            </div>
            <nav class="navigation">
                <ul>
                    <li><a href="http://localhost:9090/api/formindex" class="nav-link">–ì–ª–∞–≤–Ω–∞—è</a></li>
                    <li><a href="http://localhost:9090/api/formsvedeniy" class="nav-link">–û –Ω–∞—Å</a></li>
                    <li><a href="http://localhost:9090/api/formassortiment" class="nav-link">–ê—Å—Å–æ—Ä—Ç–∏–º–µ–Ω—Ç</a></li>
                    <li><a href="http://localhost:9090/api/formyslygs" class="nav-link">–£—Å–ª—É–≥–∏</a></li>
                    <li><a href="http://localhost:9090/api/formotziv" class="nav-link">–û—Ç–∑—ã–≤—ã</a></li>
                    <li><a href="http://localhost:9090/api/formcontact" class="nav-link">–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</a></li>
                    <li th:if="${user != null}">
                        <a href="http://localhost:9090/api/formspecial" class="personal-cabinet-btn">
                            <i class="fas fa-user"></i> –ö–∞–±–∏–Ω–µ—Ç
                        </a>
                    </li>
                    <li th:if="${user == null}">
                        <a href="http://localhost:9090/api/formauto" class="nav-link">–í–æ–π—Ç–∏</a>
                    </li>
                </ul>
            </nav>
        </div>
    </div>
</header>

<main>
    <div class="order-container">
        <h2>–û—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞ —Ä–∞–º–∫–∏</h2>

        <div th:if="${successMessage}" class="alert alert-success" role="alert">
            <span th:text="${successMessage}"></span>
        </div>
        <div th:if="${errorMessage}" class="alert alert-danger" role="alert">
            <span th:text="${errorMessage}"></span>
        </div>

        <!-- –°–æ–æ–±—â–µ–Ω–∏–µ –æ–± —É—Å–ø–µ—à–Ω–æ–º –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏–∏ –∑–∞–∫–∞–∑–∞ -->
        <div id="successMessage" class="success-message" style="display: none;">
            <i class="fas fa-check-circle"></i>
            <span>–ó–∞–∫–∞–∑ —É—Å–ø–µ—à–Ω–æ –æ—Ñ–æ—Ä–º–ª–µ–Ω! –ú—ã —Å–≤—è–∂–µ–º—Å—è —Å –≤–∞–º–∏ –≤ –±–ª–∏–∂–∞–π—à–µ–µ –≤—Ä–µ–º—è.</span>
        </div>

        <div th:if="${user == null}" class="alert alert-warning">
            <p>–î–ª—è –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è –∑–∞–∫–∞–∑–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ <a href="/api/formauto">–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞—Ç—å—Å—è</a></p>
        </div>

        <div th:if="${user != null && role == 'customer'}" class="form-section">
            <form id="frame-order-form" th:action="@{/api/createFrameOrder}" method="post" onsubmit="handleOrderSubmit(event)">

                <!-- –†–∞–∑–º–µ—Ä—ã —Ä–∞–º–∫–∏ -->
                <div class="form-group">
                    <h3>üìè –†–∞–∑–º–µ—Ä—ã —Ä–∞–º–∫–∏</h3>
                    <div class="dimension-inputs">
                        <div class="input-group">
                            <label for="width">–®–∏—Ä–∏–Ω–∞ (–º–º):</label>
                            <input type="number" id="width" name="width" required min="50" max="2000"
                                   placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: 300">
                        </div>
                        <div class="input-group">
                            <label for="height">–í—ã—Å–æ—Ç–∞ (–º–º):</label>
                            <input type="number" id="height" name="height" required min="50" max="2000"
                                   placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: 400">
                        </div>
                    </div>
                </div>

                <!-- –í—ã–±–æ—Ä –º–∞—Ç–µ—Ä–∏–∞–ª–∞ -->
                <div class="form-group">
                    <h3>üñºÔ∏è –ú–∞—Ç–µ—Ä–∏–∞–ª –±–∞–≥–µ—Ç–∞</h3>
                    <div class="material-options">
                        <!-- –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç —Å data-–∞—Ç—Ä–∏–±—É—Ç–æ–º -->
                        <div th:each="material : ${frameMaterials}" class="material-option"
                             th:attr="data-material-id=${material.id}" onclick="selectMaterial(this)">
                            <input type="radio" name="frameMaterialId" th:value="${material.id}"
                                   th:id="'material_' + ${material.id}" style="display: none;" required>
                            <strong th:text="${material.name}">–ú–∞—Ç–µ—Ä–∏–∞–ª</strong>
                            <div class="material-info">
                                <small th:text="'–¶–≤–µ—Ç: ' + ${material.color}"></small><br>
                                <small th:text="'–¶–µ–Ω–∞: ' + ${material.pricePerMeter} + ' ‚ÇΩ/–º'"></small><br>
                                <small th:text="'–®–∏—Ä–∏–Ω–∞: ' + ${material.width} + ' –º–º'"></small>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –æ–ø—Ü–∏–∏ -->
                <div class="optional-section">
                    <h3>üé® –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)</h3>

                    <div class="input-group">
                        <label for="color">–¶–≤–µ—Ç —Ä–∞–º–∫–∏:</label>
                        <input type="text" id="color" name="color"
                               placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –Ω–∞—Ç—É—Ä–∞–ª—å–Ω–æ–µ –¥–µ—Ä–µ–≤–æ, —á–µ—Ä–Ω—ã–π –º–∞—Ç–æ–≤—ã–π">
                    </div>

                    <div class="input-group">
                        <label for="style">–°—Ç–∏–ª—å —Ä–∞–º–∫–∏:</label>
                        <select id="style" name="style">
                            <option value="">–í—ã–±–µ—Ä–∏—Ç–µ —Å—Ç–∏–ª—å</option>
                            <option value="–ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π">–ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π</option>
                            <option value="–ú–æ–¥–µ—Ä–Ω">–ú–æ–¥–µ—Ä–Ω</option>
                            <option value="–í–∏–Ω—Ç–∞–∂">–í–∏–Ω—Ç–∞–∂</option>
                            <option value="–ú–∏–Ω–∏–º–∞–ª–∏–∑–º">–ú–∏–Ω–∏–º–∞–ª–∏–∑–º</option>
                            <option value="–ö–∞–Ω—Ç—Ä–∏">–ö–∞–Ω—Ç—Ä–∏</option>
                        </select>
                    </div>

                    <div class="input-group">
                        <label for="mountType">–¢–∏–ø –∫—Ä–µ–ø–ª–µ–Ω–∏—è:</label>
                        <select id="mountType" name="mountType">
                            <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –∫—Ä–µ–ø–ª–µ–Ω–∏–µ</option>
                            <option value="–ü–æ–¥–≤–µ—Å–Ω–æ–µ">–ü–æ–¥–≤–µ—Å–Ω–æ–µ</option>
                            <option value="–ù–∞—Å—Ç–æ–ª—å–Ω–æ–µ">–ù–∞—Å—Ç–æ–ª—å–Ω–æ–µ</option>
                            <option value="–ù–∞–ø–æ–ª—å–Ω–æ–µ">–ù–∞–ø–æ–ª—å–Ω–æ–µ</option>
                        </select>
                    </div>

                    <div class="input-group">
                        <label for="glassType">–¢–∏–ø —Å—Ç–µ–∫–ª–∞:</label>
                        <select id="glassType" name="glassType">
                            <option value="">–í—ã–±–µ—Ä–∏—Ç–µ —Å—Ç–µ–∫–ª–æ</option>
                            <option value="–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ">–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ</option>
                            <option value="–ê–Ω—Ç–∏–±–ª–∏–∫–æ–≤–æ–µ">–ê–Ω—Ç–∏–±–ª–∏–∫–æ–≤–æ–µ</option>
                            <option value="–ë–µ–∑ —Å—Ç–µ–∫–ª–∞">–ë–µ–∑ —Å—Ç–µ–∫–ª–∞</option>
                            <option value="–û—Ä–≥—Å—Ç–µ–∫–ª–æ">–û—Ä–≥—Å—Ç–µ–∫–ª–æ</option>
                        </select>
                    </div>

                    <div class="input-group">
                        <label for="notes">–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø–æ–∂–µ–ª–∞–Ω–∏—è:</label>
                        <textarea id="notes" name="notes" rows="4"
                                  placeholder="–û–ø–∏—à–∏—Ç–µ –æ—Å–æ–±—ã–µ –ø–æ–∂–µ–ª–∞–Ω–∏—è –∫ –∑–∞–∫–∞–∑—É..."></textarea>
                    </div>
                </div>

                <button type="submit" class="btn-primary">
                    <i class="fas fa-check"></i> –û—Ñ–æ—Ä–º–∏—Ç—å –∑–∞–∫–∞–∑
                </button>
            </form>
        </div>

        <div th:if="${user != null && role != 'customer'}" class="alert alert-info">
            <p>–û—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–æ–≤ –¥–æ—Å—Ç—É–ø–Ω–æ —Ç–æ–ª—å–∫–æ –¥–ª—è –ø–æ–∫—É–ø–∞—Ç–µ–ª–µ–π</p>
        </div>
    </div>
</main>

<footer class="footer">
    <div class="autocontainer">
        <p>&copy; 2025 –ë–∞–≥–µ—Ç–Ω–∞—è –º–∞—Å—Ç–µ—Ä—Å–∫–∞—è. –í—Å–µ –ø—Ä–∞–≤–∞ –∑–∞—â–∏—â–µ–Ω—ã.</p>
    </div>
</footer>

<script>
    function redirectToPersonal() {
        window.location.href = 'http://localhost:9090/api/formspecial';
    }

    function selectMaterial(element) {
        // –°–Ω–∏–º–∞–µ–º –≤—ã–¥–µ–ª–µ–Ω–∏–µ —Å–æ –≤—Å–µ—Ö –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤
        document.querySelectorAll('.material-option').forEach(opt => {
            opt.classList.remove('selected');
        });

        // –í—ã–¥–µ–ª—è–µ–º –≤—ã–±—Ä–∞–Ω–Ω—ã–π –º–∞—Ç–µ—Ä–∏–∞–ª
        element.classList.add('selected');

        // –ù–∞—Ö–æ–¥–∏–º radio –∫–Ω–æ–ø–∫—É –≤–Ω—É—Ç—Ä–∏ —ç–ª–µ–º–µ–Ω—Ç–∞ –∏ –æ—Ç–º–µ—á–∞–µ–º –µ—ë
        const radioInput = element.querySelector('input[type="radio"]');
        if (radioInput) {
            radioInput.checked = true;
        }
    }

function handleOrderSubmit(event) {
    event.preventDefault();

    const width = document.getElementById('width').value;
    const height = document.getElementById('height').value;
    const materialSelected = document.querySelector('input[name="frameMaterialId"]:checked');

    // –í–∞–ª–∏–¥–∞—Ü–∏—è
    if (width < 50 || width > 2000) {
        alert('–®–∏—Ä–∏–Ω–∞ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –æ—Ç 50 –¥–æ 2000 –º–º');
        return;
    }

    if (height < 50 || height > 2000) {
        alert('–í—ã—Å–æ—Ç–∞ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –æ—Ç 50 –¥–æ 2000 –º–º');
        return;
    }

    if (!materialSelected) {
        alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ –º–∞—Ç–µ—Ä–∏–∞–ª –±–∞–≥–µ—Ç–∞');
        return;
    }

    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± —É—Å–ø–µ—Ö–µ
    const successMessage = document.getElementById('successMessage');
    successMessage.style.display = 'block';
    successMessage.scrollIntoView({ behavior: 'smooth' });

    // –°–∫—Ä—ã–≤–∞–µ–º —Ñ–æ—Ä–º—É
    const formSection = document.querySelector('.form-section');
    formSection.style.display = 'none';

    // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —Ñ–æ—Ä–º—É –Ω–∞ —Å–µ—Ä–≤–µ—Ä –ø–æ—Å–ª–µ –Ω–µ–±–æ–ª—å—à–æ–π –∑–∞–¥–µ—Ä–∂–∫–∏
    setTimeout(() => {
        event.target.submit();
    }, 2000);
}

</script>
</body>
</html>
